{
  "info": {
    "_postman_id": "1b0daf2e-b50b-41de-bd23-76442fb20800",
    "name": "wdv353-moduletwo",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "5163548",
    "_collection_link": "https://go.postman.co/collection/5163548-1b0daf2e-b50b-41de-bd23-76442fb20800?source=collection_link"
  },
  "item": [
    {
      "name": "users",
      "item": [
        {
          "name": "Create user",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 201\", function () {",
                  "  pm.response.to.have.status(201);",
                  "});",
                  "pm.test(\"Reponse has created resource ID\", function() {",
                  "    const responseBody = pm.response.json();",
                  "    pm.expect(responseBody.data).to.have.property(\"_id\").that.is.not.null;",
                  "    pm.expect(responseBody.data._id).to.have.lengthOf(24);",
                  "",
                  "    pm.collectionVariables.set(\"userId\", responseBody.data._id);",
                  "})",
                  "pm.test(\"Response has properties\", () => {",
                  "    const { data } = pm.response.json();",
                  "    pm.expect(data.username).to.be.a('string');",
                  "",
                  "    pm.expect(data.age).to.be.a('number');",
                  "",
                  "    pm.expect(data.password).to.be.a('string');",
                  "})"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"username\": \"adm\",\n    \"password\": \"Password\",\n    \"age\": \"20\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://localhost:3000/api/v1/users",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "3000",
              "path": [
                "api",
                "v1",
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Get all users",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", () => {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "pm.test(\"Response contains an array of users\", () => {",
                  "    const { data } = pm.response.json();",
                  "    pm.expect(data).to.be.an(\"array\");",
                  "});",
                  "pm.test(\"Users do not include password or __v\", () => {",
                  "    const { data } = pm.response.json();",
                  "    if (data.length > 0) {  ",
                  "        pm.expect(data[0]).to.not.have.property(\"password\");",
                  "        pm.expect(data[0]).to.not.have.property(\"__v\");",
                  "    }",
                  "});"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:3000/api/v1/users",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "3000",
              "path": [
                "api",
                "v1",
                "users"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Get user by userId",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", () => {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Returned user matches requested ID\", () => {",
                  "    const responseBody = pm.response.json();",
                  "    pm.expect(responseBody.data._id).to.eql(pm.collectionVariables.get(\"userId\"));",
                  "});",
                  "",
                  "pm.test(\"User does not include password or __v\", () => {",
                  "    const { data } = pm.response.json();",
                  "    pm.expect(data).to.not.have.property(\"password\");",
                  "    pm.expect(data).to.not.have.property(\"__v\");",
                  "});",
                  ""
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "method": "GET",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"user\": \"696e9d37ce5752cfea32f247\",\n    \"username\": \"Test\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://localhost:3000/api/v1/users/{{userId}}",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "3000",
              "path": [
                "api",
                "v1",
                "users",
                "{{userId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Edit user by userId",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", () => {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"User updated with correct type\", () => {",
                  "    const { data } = pm.response.json();",
                  "    pm.expect(data.age).to.be.a('number');",
                  "    pm.expect(data.username).to.be.a('string');",
                  "    pm.expect(data.password).to.be.a('string');",
                  "});",
                  "",
                  "pm.test(\"Returned userId has not been changed\", () => {",
                  "    const { data } = pm.response.json();",
                  "    pm.expect(data._id).to.eql(pm.collectionVariables.get(\"userId\"));",
                  "});",
                  ""
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"age\": \"30\",\n    \"username\": \"admiun\",\n    \"passweord\": \"Password123\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://localhost:3000/api/v1/users/{{userId}}",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "3000",
              "path": [
                "api",
                "v1",
                "users",
                "{{userId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Delete user by userId",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", () => {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"User deleted\", () => {",
                  "    const { message } = pm.response.json();",
                  "    pm.expect(message).to.eql(\"User deleted successfully\");",
                  "});",
                  "",
                  "pm.test(\"Deleted user ID matches requested ID\", () => {",
                  "    const { data } = pm.response.json();",
                  "    pm.expect(data._id).to.eql(pm.collectionVariables.get(\"userId\"));",
                  "});",
                  ""
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://localhost:3000/api/v1/users/{{userId}}",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "3000",
              "path": [
                "api",
                "v1",
                "users",
                "{{userId}}"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "posts",
      "item": [
        {
          "name": "Create post",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 201\", function () {",
                  "  pm.response.to.have.status(201);",
                  "});",
                  "pm.test(\"Reponse has created resource ID\", function() {",
                  "    const responseBody = pm.response.json();",
                  "    pm.expect(responseBody.data).to.have.property(\"_id\").that.is.not.null;",
                  "    pm.expect(responseBody.data._id).to.have.lengthOf(24);",
                  "",
                  "    pm.collectionVariables.set(\"postId\", responseBody.data._id);",
                  "})",
                  "pm.test(\"Response has properties\", () => {",
                  "    const { data } = pm.response.json();",
                  "    pm.expect(data.title).to.be.a('string');",
                  "    pm.expect(data.title).to.be.eql('New Post');",
                  "",
                  "    pm.expect(data.content).to.be.a('string');",
                  "    pm.expect(data.content).to.be.eql(\"This is a new post\");    ",
                  "",
                  "})"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"title\": \"A Post\",\n    \"content\": \"This is a new post\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/posts",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "posts"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Get all posts",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", () => {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "pm.test(\"Response contains an array of posts\", () => {",
                  "    const { data } = pm.response.json();",
                  "    pm.expect(data).to.be.an(\"array\");",
                  "});",
                  "pm.test(\"Posts do not include __v\", () => {",
                  "    const { data } = pm.response.json();",
                  "    if (data.length > 0) {  ",
                  "        pm.expect(data[0]).to.not.have.property(\"__v\");",
                  "    }",
                  "});"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "http://localhost:3000/api/v1/posts",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "3000",
              "path": [
                "api",
                "v1",
                "posts"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Get post by postId",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", () => {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Returned post matches requested ID\", () => {",
                  "    const responseBody = pm.response.json();",
                  "    pm.expect(responseBody.data._id).to.eql(pm.collectionVariables.get(\"postId\"));",
                  "});",
                  "",
                  "pm.test(\"Post does not include __v\", () => {",
                  "    const { data } = pm.response.json();",
                  "    pm.expect(data).to.not.have.property(\"__v\");",
                  "});",
                  ""
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "protocolProfileBehavior": {
            "disableBodyPruning": true
          },
          "request": {
            "method": "GET",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://localhost:3000/api/v1/posts/{{postId}}",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "3000",
              "path": [
                "api",
                "v1",
                "posts",
                "{{postId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Edit post by postId",
          "request": {
            "method": "PUT",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"title\": \"Updated Post\",\n    \"content\": \"This is am updated post\"\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "http://localhost:3000/api/v1/posts/{{postId}}",
              "protocol": "http",
              "host": [
                "localhost"
              ],
              "port": "3000",
              "path": [
                "api",
                "v1",
                "posts",
                "{{postId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Delet post by postId",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status code is 200\", () => {",
                  "    pm.response.to.have.status(200);",
                  "});",
                  "",
                  "pm.test(\"Post deleted\", () => {",
                  "    const { message } = pm.response.json();",
                  "    pm.expect(message).to.eql(\"Post deleted successfully\");",
                  "});",
                  "",
                  "pm.test(\"Deleted post ID matches requested ID\", () => {",
                  "    const { data } = pm.response.json();",
                  "    pm.expect(data._id).to.eql(pm.collectionVariables.get(\"postId\"));",
                  "});",
                  ""
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{baseUrl}}/posts/{{postId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "posts",
                "{{postId}}"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Get posts by operators",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", () => {",
              "    pm.response.to.have.status(200);",
              "});",
              "pm.test(\"Response contains an array of posts\", () => {",
              "    const { data } = pm.response.json();",
              "    pm.expect(data).to.be.an(\"array\");",
              "});",
              "pm.test(\"Posts do not include __v\", () => {",
              "    const { data } = pm.response.json();",
              "    if (data.length > 0) {  ",
              "        pm.expect(data[0]).to.not.have.property(\"__v\");",
              "    }",
              "});"
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/posts?likes[gte]=0&likes[lte]=100&select=title,likes,user,content&page=1&limit=5",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "posts"
          ],
          "query": [
            {
              "key": "user",
              "value": "{{userId}}",
              "disabled": true
            },
            {
              "key": "likes[gte]",
              "value": "0"
            },
            {
              "key": "likes[lte]",
              "value": "100"
            },
            {
              "key": "select",
              "value": "title,likes,user,content"
            },
            {
              "key": "sort",
              "value": "-title",
              "disabled": true
            },
            {
              "key": "page",
              "value": "1"
            },
            {
              "key": "limit",
              "value": "5"
            }
          ]
        }
      },
      "response": []
    },
    {
      "name": "Get posts sort",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", () => {",
              "    pm.response.to.have.status(200);",
              "});",
              "pm.test(\"Response contains an array of posts\", () => {",
              "    const { data } = pm.response.json();",
              "    pm.expect(data).to.be.an(\"array\");",
              "});",
              "pm.test(\"Posts do not include __v\", () => {",
              "    const { data } = pm.response.json();",
              "    if (data.length > 0) {  ",
              "        pm.expect(data[0]).to.not.have.property(\"__v\");",
              "    }",
              "});"
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/posts?select=title,likes,user,content&sort=title&page=1&limit=3",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "posts"
          ],
          "query": [
            {
              "key": "user",
              "value": "{{userId}}",
              "disabled": true
            },
            {
              "key": "likes[gte]",
              "value": "0",
              "disabled": true
            },
            {
              "key": "likes[lte]",
              "value": "100",
              "disabled": true
            },
            {
              "key": "select",
              "value": "title,likes,user,content"
            },
            {
              "key": "sort",
              "value": "title"
            },
            {
              "key": "page",
              "value": "1"
            },
            {
              "key": "limit",
              "value": "3"
            }
          ]
        }
      },
      "response": []
    },
    {
      "name": "Register user",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 201\", function () {",
              "\tpm.response.to.have.status(201);",
              "});",
              "",
              "pm.test(\"Response contains token and user\", function () {",
              "\tconst responseBody = pm.response.json();",
              "",
              "\tpm.expect(responseBody).to.have.property(\"token\");",
              "\tpm.expect(responseBody.token).to.be.a(\"string\");",
              "",
              "\tpm.expect(responseBody).to.have.property(\"user\");",
              "\tpm.expect(responseBody.user).to.have.property(\"id\");",
              "\tpm.expect(responseBody.user.id).to.have.lengthOf(24);",
              "\tpm.expect(responseBody.user).to.have.property(\"username\");",
              "});",
              "",
              "pm.collectionVariables.set(\"token\", pm.response.json().token);",
              "pm.collectionVariables.set(\"userId\", pm.response.json().user.id);",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        },
        {
          "listen": "prerequest",
          "script": {
            "exec": [
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"admin\",\n    \"password\": \"Password123\",\n    \"age\": \"28\"\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{baseUrl}}/auth/register",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "auth",
            "register"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Login user",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "\tpm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Login returns valid JWT\", function () {",
              "\tconst responseBody = pm.response.json();",
              "",
              "\tpm.expect(responseBody).to.have.property(\"token\");",
              "\tpm.expect(responseBody.token).to.be.a(\"string\");",
              "",
              "\tpm.expect(responseBody).to.have.property(\"user\");",
              "\tpm.expect(responseBody.user).to.have.property(\"id\");",
              "\tpm.expect(responseBody.user.id).to.have.lengthOf(24);",
              "});",
              "pm.collectionVariables.set(\"token\", pm.response.json().token);",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"username\": \"testing\",\n    \"password\": \"Password\"\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{baseUrl}}/auth/login",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "auth",
            "login"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Get users by operators",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", () => {",
              "    pm.response.to.have.status(200);",
              "});",
              "pm.test(\"Response contains an array of posts\", () => {",
              "    const { data } = pm.response.json();",
              "    pm.expect(data).to.be.an(\"array\");",
              "});",
              "pm.test(\"Posts do not include __v\", () => {",
              "    const { data } = pm.response.json();",
              "    if (data.length > 0) {  ",
              "        pm.expect(data[0]).to.not.have.property(\"__v\");",
              "    }",
              "});"
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/users?age[gte]=0&age[lte]=50&select=username,active,age,createdAt&page=1&limit=3",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "users"
          ],
          "query": [
            {
              "key": "user",
              "value": "{{userId}}",
              "disabled": true
            },
            {
              "key": "age[gte]",
              "value": "0"
            },
            {
              "key": "age[lte]",
              "value": "50"
            },
            {
              "key": "select",
              "value": "username,active,age,createdAt"
            },
            {
              "key": "sort",
              "value": "username",
              "disabled": true
            },
            {
              "key": "page",
              "value": "1"
            },
            {
              "key": "limit",
              "value": "3"
            }
          ]
        }
      },
      "response": []
    },
    {
      "name": "Get users sort",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", () => {",
              "    pm.response.to.have.status(200);",
              "});",
              "pm.test(\"Response contains an array of posts\", () => {",
              "    const { data } = pm.response.json();",
              "    pm.expect(data).to.be.an(\"array\");",
              "});",
              "pm.test(\"Posts do not include __v\", () => {",
              "    const { data } = pm.response.json();",
              "    if (data.length > 0) {  ",
              "        pm.expect(data[0]).to.not.have.property(\"__v\");",
              "    }",
              "});"
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/users?select=username,active,age,createdAt&sort=username&page=1&limit=2",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "users"
          ],
          "query": [
            {
              "key": "user",
              "value": "{{userId}}",
              "disabled": true
            },
            {
              "key": "age[gte]",
              "value": "0",
              "disabled": true
            },
            {
              "key": "age[lte]",
              "value": "50",
              "disabled": true
            },
            {
              "key": "select",
              "value": "username,active,age,createdAt"
            },
            {
              "key": "sort",
              "value": "username"
            },
            {
              "key": "page",
              "value": "1"
            },
            {
              "key": "limit",
              "value": "2"
            }
          ]
        }
      },
      "response": []
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{token}}",
        "type": "string"
      }
    ]
  },
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "packages": {},
        "requests": {},
        "exec": [
          ""
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "packages": {},
        "requests": {},
        "exec": [
          ""
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "userId",
      "value": ""
    },
    {
      "key": "postId",
      "value": ""
    },
    {
      "key": "token",
      "value": ""
    }
  ]
}